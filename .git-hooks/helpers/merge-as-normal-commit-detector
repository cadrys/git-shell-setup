#!/bin/sh

#usage:
#   merge-as-normal-commit-detector <commit_range>
#
# Return merge commit(s) recorded as normal commit(s) from given
# commit range.

# Look for commit subjects starting with:
#	Merge branch ...
#	Merge branches ...
#	Merge remote-tracking branch ...
#	Merge remote-tracking branches ...
#	Merge commit ...
#	Merge commits ...
#	Merge tag ...
#	Merge tags ...
commit_range="$1"
commits=$(git log $commit_range \
	--pretty="format:%H #delim# %s" --no-abbrev-commit --no-decorate --no-merges \
| egrep ' #delim# Merge (((remote-tracking )?branch(es)?)|(commit(s)?)|(tag(s)?)) ' \
| sed 's/ #delim# .*//')
if [ ! -z "$commits" ]; then
	echo "$commits"
fi
