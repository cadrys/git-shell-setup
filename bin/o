#!/bin/sh

if [ $# -gt 0 ]; then
	if [ "$1" = "-" ]; then
		# see https://gist.github.com/earthgecko/3089509
		random=$(cat /dev/urandom | tr -dc 'a-zA-Z_-' | fold -w 8 | head -n 1)
		stdinfile="/tmp/stdin-$random"
		exec > "$stdinfile"
		while IFS= read -r line; do
			printf '%s\n' "$line"
		done
		exec $EDITOR "$stdinfile" &
	# scite - reads from stdin into Untitled buffer in foreground
	# scite -@ reads files from stdin in foreground
	#elif [ "$EDITOR" = "scite" ] && [ "$1" = "-" ]; then
	#	exec $EDITOR -
	else
		exec $EDITOR "$@" &
	fi
else
	args=""
	while read data; do
		args=$args$data" "
	done
	case "$OSTYPE" in
		linux* | msys*)
			exec echo $args | xargs -r $EDITOR &
			;;
		darwin*)
			exec echo $args | xargs $EDITOR &
			;;
	esac
fi
