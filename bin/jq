#!/bin/sh

# commit
#	parse ticket from commit message and pass
if [ $# -eq 1 ] && [[ $(git cat-file -t "$1" 2>/dev/null) == "commit" ]]; then
	commit="$1"
	ticket=$(git log -1 "$commit" --pretty=%s | cut -d' ' -f1 | cut -d'-' -f2)
	if [[ $ticket =~ [^[:digit:]] ]]; then
		# ticket not present
		echo 1>&2 "fatal: no ticket found"
		exit 1
	else
		jq "$ticket"
		exit
	fi
fi

# query
#	pass all args
start chrome --new-window "$JiraUrl$*"
